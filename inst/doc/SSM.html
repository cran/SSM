<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Peter Curtis" />

<meta name="date" content="2017-07-04" />

<title>Smooth supersaturated models</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Smooth supersaturated models</h1>
<h4 class="author"><em>Peter Curtis</em></h4>
<h4 class="date"><em>2017-07-04</em></h4>



<div id="smooth-supersaturated-models" class="section level2">
<h2>Smooth supersaturated models</h2>
<p>Smooth supersaturated models (SSM) are polynomial models with more terms than there are design points, with the model coefficients selected as thoe that produce the model that minimizes the roughness. Formally, let <span class="math inline">\(d=(d_1, \dotsc, d_n)^T\)</span> be a vector of n design points (with no replicated points) in <span class="math inline">\(d\)</span> factors and let <span class="math inline">\(y=(y_1, \dotsc, y_n)^T\)</span> be a vector of associated observations. Let <span class="math inline">\(f(x)\)</span> be an <span class="math inline">\(N \times 1\)</span> vector containing a set of linearly independent polynomials with <span class="math inline">\(N &gt; n\)</span>. The smooth supersaturated model is defined as <span class="math display">\[s(x)=f(x)^T\theta,\]</span> with <span class="math inline">\(\theta\)</span> being the coefficient vector such that for all <span class="math inline">\(i\in 1,\dotsc,n\)</span> we have <span class="math inline">\(s(x_i)=y_i\)</span> and <span class="math display">\[\int_{\mathcal X}\sum_{i,j}\frac{\partial s(x)}{\partial x_i \partial x_j}^2~\mathrm dx\]</span> is minimised.</p>
<p>Smooth supersaturated models are are spline-like models and converge to splines as <span class="math inline">\(N\rightarrow\infty\)</span>. The polynomial nature of the model means that sensitivity indices are computed analytically from the coefficient vector <span class="math inline">\(\theta\)</span>.</p>
<p>The <code>SSM</code> package defines an S4 class called <code>&quot;SSM&quot;</code> which contains all the information regarding the model basis <span class="math inline">\(f(x)\)</span>, the coefficient vector <span class="math inline">\(\theta\)</span> as well as numerous other information regarding the model such as sensititivity indices and estimated metamodel error. The main function provided by the <code>SSM</code> package is <code>fit.ssm</code> and this is used to construct smooth supersaturated models and analyze them as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">design &lt;-<span class="st"> </span><span class="kw">seq</span>(-<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.25</span>)
responses &lt;-<span class="st"> </span><span class="kw">sapply</span>(design, <span class="st">&quot;^&quot;</span>, <span class="dv">2</span>)
s &lt;-<span class="st"> </span><span class="kw">fit.ssm</span>(design, responses)
s
## Smooth supersaturated model in d=1 variables with N=29 terms over design of n=9 points.
## Smoothness measure Psi_2=7.423354</code></pre></div>
<p>Also included are methods to plot SSM and predict with SSM.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">predict</span>(s, <span class="fl">0.5</span>)
## [1] 0.25
<span class="kw">plot</span>(s)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Additionally, the <code>sensitivity.plot</code> function is useful for visually identifying important variables and interactions in the model. The <code>transform11</code> function is used to transform designs to lay within <span class="math inline">\(\left[-1, 1\right]^d\)</span>, which is assumed by the default behaviour of <code>fit.ssm</code>.</p>
</div>
<div id="fit.ssm" class="section level2">
<h2>fit.ssm</h2>
<p>In this section we discuss the use of the <code>fit.ssm</code> function. At it’s most basic level it only needs to be supplied with a design – a matrix with each design point being a row, or a vector for one factor data – and a matching vector of responses. It will then generate an appropriately sized basis and fit a model smoothing over <span class="math inline">\(\left[-1, 1\right]^d\)</span>.</p>
<p>The behaviour of <code>fit.ssm</code> is highly customisable. We highlight the four most useful options:</p>
<ul>
<li><code>basis_size</code>: This option sets the size <span class="math inline">\(N\)</span> of the generated basis. By default, when supplied with a dataset of <span class="math inline">\(n\)</span> points in <span class="math inline">\(d\)</span> factors, <code>fit.ssm</code> will generate a basis with <span class="math inline">\(N = 20 \times d + n\)</span> polynomial terms. Larger values of <span class="math inline">\(N\)</span> will produce smoother models and are therefore desirable. However, large values of <span class="math inline">\(N\)</span> come at a computational cost so the default <span class="math inline">\(N\)</span> is rather conservative. Also, values too large will result in numeric instability. It is recommended to plot SSM to check if there are artifacts around the smoothing region border and reducing <span class="math inline">\(N\)</span> if problems are present.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># default behaviour</span>
s   &lt;-<span class="st"> </span><span class="kw">fit.ssm</span>(design, responses); s
## Smooth supersaturated model in d=1 variables with N=29 terms over design of n=9 points.
## Smoothness measure Psi_2=7.423354
<span class="co"># too large to fit</span>
s100 &lt;-<span class="st"> </span><span class="kw">fit.ssm</span>(design, responses, <span class="dt">basis_size =</span> <span class="dv">100</span>); s100
## Warning: Unable to fit model due to numeric instability.
## Try reducing the basis size, which is currently 100TRUE
## Smooth supersaturated model in d=1 variables with N=100 terms over design of n=9 points.
## No SSM has been fit.
<span class="co"># instabilty indicated by plot</span>
s70 &lt;-<span class="st"> </span><span class="kw">fit.ssm</span>(design, responses, <span class="dt">basis_size =</span> <span class="dv">70</span>); s70
## Smooth supersaturated model in d=1 variables with N=70 terms over design of n=9 points.
## Smoothness measure Psi_2=3.42958
<span class="kw">plot</span>(s70, <span class="dt">main =</span> <span class="st">&quot;70 terms&quot;</span>)

s50 &lt;-<span class="st"> </span><span class="kw">fit.ssm</span>(design, responses, <span class="dt">basis_size =</span> <span class="dv">50</span>); s50
## Smooth supersaturated model in d=1 variables with N=50 terms over design of n=9 points.
## Smoothness measure Psi_2=5.452904
<span class="kw">plot</span>(s50, <span class="dt">main =</span> <span class="st">&quot;50 terms&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><img src="data:image/png;base64,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" /></p>
<ul>
<li><code>SA</code>: If <code>SA</code> is set to TRUE, then sensitivity indices will be computed for the fitted model. This process is based on the FANOVA decompostition of the model as <span class="math display">\[s\left(x\right)=s_0+\sum_{i_1=1}^ds_{i_1}\left(x_{i_1}\right)+\sum_{i_1=1}^d\sum_{i_2=i_1+1}^ds_{i_1i_2}\left(x_{i_1}, x_{i_2}\right)+\cdots+s_{i_1\dotsc i_d}\left(x_{i_1},\dotsc,x_{i_d}\right),\]</span> where the terms are orthogonal with respect to some probability measure. The default Legendre polynomials are orthogonal with respect to a uniform measure over <span class="math inline">\(\left[-1, 1\right]^d\)</span>. Given a subset of variables <span class="math inline">\(I = \left\{x_{i_1}, \dotsc, x_{i_m}\right\}\)</span>, integrating <span class="math inline">\(s_{i_1\dots\i_m}^2\)</span> with respect to the measure gives the associated variance <span class="math inline">\(D_I\)</span>. The proportion of total variance associated with a given variable or set of variables is known as the Sobol index <span class="math inline">\(S_I\)</span>. The polynomial nature of SSM provides an analytic formula for these Sobol indices. Also computed are Total indices which are the sum of all <span class="math inline">\(S_J\)</span> for which <span class="math inline">\(I\subset J\)</span>. Printing an SSM object displays the Sobol indices and Total indices for main effects only. Sobol indices are computed for all possible interactions when <span class="math inline">\(d&lt;11\)</span> and are stored within the SSM object - see the documentation for more information. Total interaction indices are a special case of Total index where <span class="math inline">\(\lvert I\rvert = 2\)</span> and are useful for identifying when interactions are present in the model. The <code>sensitivity.plot</code> function provides useful ways of visualising the sensitivity indices.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f &lt;-<span class="st"> </span>function(x) <span class="kw">sum</span>(x *<span class="st"> </span><span class="dv">1</span>:<span class="dv">3</span>) +<span class="st"> </span><span class="dv">5</span> *<span class="st"> </span>x[<span class="dv">1</span>]*x[<span class="dv">2</span>]
design &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dv">300</span>, -<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">ncol =</span> <span class="dv">3</span>)
response &lt;-<span class="st"> </span><span class="kw">apply</span>(design, <span class="dv">1</span>, f)
s &lt;-<span class="st"> </span><span class="kw">fit.ssm</span>(design, response, <span class="dt">SA =</span> <span class="ot">TRUE</span>)
## 
## Computing Sobol indices assuming inputs are uniformly distributed
##         over [-1,1]^d using Legendre polynomials.
## 
## Computing main effects.
## 
## Computing total effects.
## 
## Computing total interaction indices.
## 
## Computing Sobol indices for all order interactions.
## Computing total interaction indices.
s
## Smooth supersaturated model in d=3 variables with N=160 terms over design of n=100 points.
## Smoothness measure Psi_2=386.5796
## Main effect Sobol' indices:
## [1] 0.046 0.180 0.407
## Total indices:
## [1] 0.413 0.547 0.407
<span class="kw">sensitivity.plot</span>(s, <span class="st">&quot;main_sobol&quot;</span>, <span class="dt">cex.main =</span> <span class="fl">0.5</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAclBMVEUAAAAAADoAAGYAOjoAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6kLY6kNtmAABmtttmtv+QOgCQZgCQ2/+2ZgC2Zma2kDq225C2/9u2///bkDrbtmbb25Db29vb/9vb////AAD/tmb/25D//7b//9v////qIbXRAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAFmUlEQVR4nO3dC1fiRgBA4agYuw8srPRhuq2LyP//i50HweoCN0wDBLz3HPdoSCbJ5xilBlstbWfVqQ9g6AkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkEDR/ot8eS1TpuxfUJ9Hx3nQ9rXreLmnF+y83Gr++/22T7oJ8eX4fbudrmD2fjn9bNi94fypb6BGrGs/HLtBo9zW/Ceaf3MlD4+OphcV9VAeg5vJvfqskyrvNPWq8KUHFR86W6nV49pI3bR/+6SYzx4WA1m6Th4xhhqz/CwvDAr3G1+FheFD/83u4zHMF/Bk2L0sYnAAoH04SjHM9HT2Gy1KsZE4DCeU6a+mU6jobzOpxH3dR/L9NnOq83egorhkVN/fzLQ7tx/CfOoLh5fjgDxeHTGEE2LJxN8moJKDyWP8w7Cftcvhs0LEqPHR9oOa/qWTQKh9rk91ZAdTqJeHhfp2nexE9w/NzGE0nrxa+iMBPiFIuL0sL0T3vm+eEMFIa/jWP8XqeF6a0FWi369Gdc4ds4fT29G3T2NW18fKD46ckz6Prx7QzKh97OoNG3STzQiLKeQXW7fT6XtzMoA8UFaTKl4fMEiQtvp5PXiRb38vMMejPo6WbQvKomm69B8QwX91ef0zUoXjTiNaSaJKC83moGTVbnsr4GhWtGvrjkh8PF43N7Dbp+zNNlMqu+1GG17/GxiNB+eP2Y9rkGWo0XFqWNT/AldqS6fFfrLYGgcwQ6agJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJB/QBV63oZbkj1fEYCHXe4ASQQJBAkECQQJBAkECQQJBAkEFRyRs93kz6HG3b7nFF8RXXblpe7f2yg5bxKr/N0Bm1tcR9f3y7QjmZXDwLtrIkv5BdoR893NwLt7GVaCTSQ4br1Y6/2HLzwjJoh/Rw0RKD3o5z0txpnAHSo4bolEDQgoPinkXY8E/vwQE21+ps782rLH9/52EDprznl0t8c+5/D9dZggBb36x8Q536b35AziGra5xheg7bU/jfFLfNHoGMP1y2BIIEggSCBIIEggSCBIIEggSCBIIGgMwDytxonGq5bAkECQQJBAkECQQJBAkECQQJBAkEDAmrCs630y1VvwdtYc/WwXNzH//WQQJvKNy+8TEdPAm2svf1lNnoSaFPr219mtUAba1kW94N6vdhwgNY3CL1MBSpLoOMO160hAnmR3nMUf6txmuG6JRA0ICBfq7G7Q79Wo/BMBwN08Dvtzx3o4K/VOHcgZxB16NdqnD3QoV+rcf5ABx5OIEggSCBIIEggSCBIIEggSCBIIEgg6HKBevqtxuUC9TScQJBAkECQQJBAkECQQJBAkECQQND5A3W8/aX0iAu3K91d/0Bdb38pPeLC7Up316mD3LxQesSF25XurlMHuf2l9IgLtyvdXaecQdCe16But7+UHnHhdqW769R+38U63v5SesSF25Xu7gBAHYcrPeLC7Up3t8cZ9ZZAq3a/VqP0iAu3K91dp/r+rcbZdFygC04gqOcnq5dXz09WL6+en2pcXj0/Wb28nEFQz09WL6+en6xeXv4cBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBP0LQBPLwQ87r0UAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The grey bars indicate interactions</span>
<span class="kw">sensitivity.plot</span>(s, <span class="st">&quot;sobol&quot;</span>, <span class="dt">cex.main =</span> <span class="fl">0.5</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># This plots total indices for main effects, and total interaction indices for second order interactions</span>
<span class="kw">sensitivity.plot</span>(s, <span class="st">&quot;total&quot;</span>, <span class="dt">cex.main =</span> <span class="fl">0.5</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>If sensitivity analysis indicates that certain interactions of main effects are unimportant, it is possible to fit a new SSM while excluding particular effects and interactions. To do this, pass a list of vectors to the <code>exclude</code> argument. The vector <code>c(1, 2)</code> is associated with the interaction between <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> for example, so <code>exclude = list(c(1,2))</code> will leave out all polynomials which are dependent on <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> only.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># A stupid example, but fit new model without main effect of first variable</span>
s3 &lt;-<span class="st"> </span><span class="kw">fit.ssm</span>(design, response, <span class="dt">SA =</span> <span class="ot">TRUE</span>, <span class="dt">exclude =</span> <span class="kw">list</span>(<span class="dv">1</span>))
## 
## Computing Sobol indices assuming inputs are uniformly distributed
##         over [-1,1]^d using Legendre polynomials.
## 
## Computing main effects.
## 
## Computing total effects.
## 
## Computing total interaction indices.
## 
## Computing Sobol indices for all order interactions.
## Computing total interaction indices.
s3
## Smooth supersaturated model in d=3 variables with N=160 terms over design of n=100 points.
## Smoothness measure Psi_2=27535.96
## Main effect Sobol' indices:
## [1] 0.00 0.18 0.28
## Total indices:
## [1] 0.511 0.691 0.421
<span class="kw">sensitivity.plot</span>(s3, <span class="st">&quot;sobol&quot;</span>, <span class="dt">cex.main =</span> <span class="fl">0.5</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It is possible to specify a user-defined polynomial basis by using the <code>basis</code>, <code>P</code> and <code>K</code> options in <code>fit.ssm</code>. If this is done then the sensitivity analysis will assume that the basis is orthonormal with respect to some probability measure which will imply the input distribution. For example, a basis of normalised Hermite polynomials implies that the input distribution is normally distributed with zero mean and unit variance.</p>
<ul>
<li><code>validation</code>: If this is set to TRUE then Leave-One-Out errors will be computed for each design point and the root mean square error (standardised against the variance of the <span class="math inline">\(\bar y\)</span> estimator) is calculated.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s &lt;-<span class="st"> </span><span class="kw">fit.ssm</span>(design, response, <span class="dt">validation =</span> <span class="ot">TRUE</span>)
s
## Smooth supersaturated model in d=3 variables with N=160 terms over design of n=100 points.
## Smoothness measure Psi_2=386.5796
## Standardised LOO RMSE = 0.01375434</code></pre></div>
<ul>
<li><code>GP</code>: If this is set to TRUE then the metamodel error is estimated using a Gaussian process procedure. This functionality is experimental in nature and should be used with caution.The credible intervals of the SSM-GP model tend to be more conservative than kriging models. By default a squared exponential correlation function is used, but a Matern 3/2 correlation can be used by setting <code>type = &quot;matern32&quot;</code>.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">design &lt;-<span class="st"> </span><span class="kw">seq</span>(-<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.25</span>)
responses &lt;-<span class="st"> </span><span class="kw">sapply</span>(design, <span class="st">&quot;^&quot;</span>, <span class="dv">2</span>)
s1 &lt;-<span class="st"> </span><span class="kw">fit.ssm</span>(design, responses, <span class="dt">GP =</span> <span class="ot">TRUE</span>)
## finding maximum likelihood estimates using &quot;exp&quot; correlation function.
s2 &lt;-<span class="st"> </span><span class="kw">fit.ssm</span>(design, responses, <span class="dt">GP =</span> <span class="ot">TRUE</span>, <span class="dt">type =</span> <span class="st">&quot;matern32&quot;</span>)
## finding maximum likelihood estimates using &quot;matern32&quot; correlation function.
<span class="kw">plot</span>(s1, <span class="dt">sub =</span> <span class="st">&quot;Squared exponential&quot;</span>)
<span class="kw">plot</span>(s2, <span class="dt">sub =</span> <span class="st">&quot;Matern 3/2&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><img src="data:image/png;base64,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" /></p>
</div>
<div id="constraints" class="section level2">
<h2>Constraints</h2>
<p>Computational expense and numerical stability lead to some constraints on the type of data suitable for smooth supersaturated models. Due to the need for <span class="math inline">\(N&gt;&gt;n\)</span>, larger dimensional datasets can be problematic in terms of memory and storage space for computation. Therefore fitting data with more than twenty variables may be time-consuming and inadvisable. For very low dimensional datasets, smooth supersaturated models are suitable for datasets with few points due to the numerical instability caused as the degree of terms in the polynomial basis get larger. It is difficult to set recommended values for <span class="math inline">\(N\)</span> as it is highly dependent on the number of variables and the design. As a rule of thumb, <span class="math inline">\(N=50\)</span> is an upper limit for one dimensional datasets, <span class="math inline">\(n=100\)</span> is generally suitable for two-dimensional datasets and <span class="math inline">\(n&gt;200\)</span> should not be a problem for more variables. In general a value of <span class="math inline">\(N\)</span> should be sought that is as high as possible such that there is no instability visible in the main effects plot.</p>
</div>
<div id="cross-validation" class="section level2">
<h2>Cross-validation</h2>
<p>Cross-validation entails the use of the same model structure with many subsets of the full dataset. Rather than recompute the necessary objects each time (e.g. <code>P</code>, <code>K</code>, and so on) it is possible to pass a pre-existing SSM object to <code>fit.ssm</code> which will then use the same structure.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ten point design in two factors</span>
X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dv">20</span>, -<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)
Y &lt;-<span class="st"> </span><span class="kw">apply</span>(X, <span class="dv">1</span>, sum)
<span class="co"># fit SSM</span>
s &lt;-<span class="st"> </span><span class="kw">fit.ssm</span>(X, Y);s
## Smooth supersaturated model in d=2 variables with N=50 terms over design of n=10 points.
## Smoothness measure Psi_2=2.09808e-29
<span class="co"># fit SSM with same structure to first nine design points only</span>
s1 &lt;-<span class="st"> </span><span class="kw">fit.ssm</span>(X[<span class="dv">1</span>:<span class="dv">9</span>, ], Y[<span class="dv">1</span>:<span class="dv">9</span>], <span class="dt">ssm =</span> s);s1
## Smooth supersaturated model in d=2 variables with N=50 terms over design of n=9 points.
## Smoothness measure Psi_2=2.09634e-29</code></pre></div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
